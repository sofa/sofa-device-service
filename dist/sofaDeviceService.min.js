/**
 * sofa-device-service - v0.5.1 - Fri Feb 06 2015 17:02:13 GMT+0100 (CET)
 * http://www.sofa.io
 *
 * Copyright (c) 2014 CouchCommerce GmbH (http://www.couchcommerce.com / http://www.sofa.io) and other contributors
 * THIS SOFTWARE CONTAINS COMPONENTS OF THE SOFA.IO COUCHCOMMERCE SDK (WWW.SOFA.IO)
 * IT IS PROVIDED UNDER THE LICENSE TERMS OF THE ATTACHED LICENSE.TXT.
 */
!function(n,t){"use strict";n.define("sofa.DeviceService",function(n){var e,i,r,o,a,d={},c=navigator.userAgent,u={},s="modern-flexbox",f="overflow-support",h="no-",m="android-2",g="ipad-ios-7",l=function(n,t,e){var i=d.getHtmlTag();i.className+=n?" "+t:" "+e+t},p=function(n){var t="unknown";return n.match(/iPad/i)||n.match(/iPhone/i)?t="iOS":n.match(/Android/i)&&(t="Android"),t},v=function(n,t){var e="unknown";return"iOS"===t&&n.match(/OS /)?e=n.substr(n.indexOf("OS ")+3,3).replace("_","."):"Android"===t&&n.match(/Android /)&&(e=n.substr(n.indexOf("Android ")+8,3)),e},x=function(){u.width=n.innerWidth,u.height=n.innerHeight},O=function(n){var t=d.getOsVersion();return 0===t.indexOf(n)},S=function(){var t=new CustomEvent("deviceService.orientationchange");n.matchMedia&&(o=n.matchMedia("screen and (min-width: 641px)"),a=n.matchMedia("screen and (orientation: portrait)")),n.matchMedia?a.addListener(function(){x(),n.dispatchEvent(t)}):n.addEventListener("orientationchange",function(){x(),n.dispatchEvent(t)},!1)},w=function(){"iOS"===i&&n.addEventListener("resize",function(){n.setTimeout(function(){t.documentElement.style.minWidth=n.innerWidth+"px"},0)})};return function(){i=p(c),r=v(c,i),x(),S(),w()}(),d.getHtmlTag=function(){return e||t.documentElement},d.isIpadOnIos7=function(){return c.match(/iPad/i)&&O("7")},d.getViewportDimensions=function(){return u},d.isInPortraitMode=function(){return n.matchMedia?a.matches:u.height>u.width},d.isInLandscapeMode=function(){return!d.isInPortraitMode()},d.isTabletSize=function(){return n.matchMedia?o.matches:n.innerWidth>640},d.isStockAndroidBrowser=function(){return"Android"===i&&c.indexOf("Chrome")<0},d.flagOverflowSupport=function(){l(d.hasOverflowSupport(),f,h)},d.getUserAgent=function(){return c},d.getOs=function(){return i},d.getOsVersion=function(){return r},d.isAndroid2x=function(){return"Android"===d.getOs()&&O("2")},d.hasOverflowSupport=function(){return"Android"===d.getOs()?!O("2"):"iOS"===d.getOs()?!(O("1")||O("2")||O("3")||O("4")):!0},d.hasModernFlexboxSupport=function(){var n=function(){var n=c.match(/Firefox\/\d{2}/);return n?1*n[0].substr(8):0};if(c.match(/Firefox/i)&&n()<28)return!1;var e=["-webkit-flex","flex"],i=t.createElement("span");return e.forEach(function(n){i.style.display=n}),e.indexOf(i.style.display)>-1},d.flagModernFlexboxSupport=function(){l(d.hasModernFlexboxSupport(),s,h)},d.flagIpadOnIos7=function(){if(d.isIpadOnIos7()){var n=d.getHtmlTag();n.className+=" "+g}},d.flagAndroid2x=function(){if(d.isAndroid2x()){var n=d.getHtmlTag();n.className+=" "+m}},d.setViewportHeightToDeviceHeight=function(){d.getHtmlTag().style.height=d.getViewportDimensions().height+"px"},d})}(sofa,document);